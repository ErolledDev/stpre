# Netlify Deployment Guide

## Prerequisites
- Netlify account
- Stripe account with test/production keys
- Firebase project with Firestore enabled

## Deployment Steps

### 1. Connect Your Repository to Netlify
- Push this project to GitHub, GitLab, or Bitbucket
- Log in to Netlify and click "Add new site"
- Import your repository

### 2. Configure Build Settings
Netlify will automatically detect the `netlify.toml` configuration file with these settings:
- **Build command**: `npm install`
- **Publish directory**: `client`
- **Functions directory**: `netlify/functions`

### 3. Set Environment Variables
In Netlify Dashboard, go to Site settings → Environment variables and add:

**Required Stripe Variables:**
- `STRIPE_PUBLISHABLE_KEY` - Your Stripe publishable key
- `STRIPE_SECRET_KEY` - Your Stripe secret key
- `STRIPE_WEBHOOK_SECRET` - Your Stripe webhook secret (see step 4)
- `BASIC_PRICE_ID` - Stripe price ID for basic plan
- `PRO_PRICE_ID` - Stripe price ID for pro plan

**Required Firebase Variables:**
- `FIREBASE_PROJECT_ID` - Your Firebase project ID
- `FIREBASE_CLIENT_EMAIL` - Firebase service account email
- `FIREBASE_PRIVATE_KEY` - Firebase service account private key (include quotes)

**Optional Variables:**
- `DOMAIN` - Your site URL (Netlify will auto-set `URL` variable)

### 4. Configure Stripe Webhook
After deploying:
1. Go to Stripe Dashboard → Developers → Webhooks
2. Click "Add endpoint"
3. Enter webhook URL: `https://your-site.netlify.app/api/webhook`
4. Select events to listen for:
   - `checkout.session.completed`
   - `customer.subscription.deleted`
5. Copy the webhook signing secret
6. Add it to Netlify environment variables as `STRIPE_WEBHOOK_SECRET`

### 5. Update Firebase Config (if needed)
If you need to update the Firebase config in `client/index.html`, make sure to use your Firebase project credentials.

### 6. Deploy
- Click "Deploy site" in Netlify
- Wait for the build to complete
- Your site will be live at the provided URL

## Testing
1. Visit your Netlify URL
2. Sign up with test credentials
3. Select a plan
4. Use Stripe test card: `4242 4242 4242 4242`
5. Verify webhook events are received in Stripe Dashboard

## Troubleshooting
- Check Netlify function logs for errors
- Verify all environment variables are set correctly
- Ensure Firebase service account has proper permissions
- Test webhook endpoint with Stripe CLI: `stripe listen --forward-to https://your-site.netlify.app/api/webhook`
